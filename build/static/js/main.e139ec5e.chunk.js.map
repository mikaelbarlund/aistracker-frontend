{"version":3,"sources":["store/vessels/types.ts","store/vessels/actions.ts","App.tsx","store/vessels/thunks.ts","store/vessels/reducers.ts","store/index.ts","index.tsx"],"names":["SET_VESSEL_LIST","setVesselList","vessels","type","payload","App","dispatch","useDispatch","useEffect","a","axios","get","data","useSelector","state","myLocation","L","latLng","blackOptions","color","weight","fillRedOptions","fillOrangeOptions","fillYellowOptions","fillGreenOptions","fillBlueOptions","MapContainer","center","zoom","scrollWheelZoom","TileLayer","attribution","url","map","v","features","f","key","_id","value","geometry","coordinates","feature","visual","properties","timestampExternal","Date","now","radius","Circle","pathOptions","Tooltip","sticky","toLocaleString","line","sort","b","Polyline","positions","undefined","direction","offset","opacity","name","destination","initialState","rootReducer","combineReducers","action","store","createStore","composeWithDevTools","applyMiddleware","thunk","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.e139ec5e.chunk.js","sourcesContent":["export interface Geometry {\n  type: string\n  coordinates: number[]\n}\nexport interface Properties {\n  mmsi: number\n  timestampExternal: number\n}\n\nexport interface Feature {\n  _id: string\n  geometry: Geometry\n  mmsi: number\n  type: string\n  properties: Properties\n}\n\nexport interface Vessel {\n  _id: string\n  mmsi: number\n  destination: string\n  name: string\n  features: Feature[]\n}\n\nexport interface VesselState {\n  vessels: Vessel[]\n}\n\nexport const SET_VESSEL_LIST = 'SET_VESSEL_LIST';\n\ninterface SetVesselListAction {\n  type: typeof SET_VESSEL_LIST\n  payload: Vessel[]\n}\n\nexport type VesselActionTypes = SetVesselListAction;","import { SET_VESSEL_LIST, Vessel, VesselActionTypes } from './types';\n\nexport function setVesselList(vessels:Vessel[]): VesselActionTypes {\n  return {\n    type: SET_VESSEL_LIST,\n    payload: vessels\n  };\n}","import React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { thunkSetVesselList } from './store/vessels/thunks';\nimport { RootState } from './store';\nimport { MapContainer, TileLayer, Circle, Polyline, Tooltip } from 'react-leaflet';\nimport './App.css';\nimport L from 'leaflet';\n\nconst App: React.FC = () => {\n  const dispatch = useDispatch();\n  useEffect(() => {\n    dispatch(thunkSetVesselList());\n  }, []);\n\n  const vessels = useSelector((state: RootState) => state.vessels.vessels);\n  const myLocation = L.latLng( 60.16, 24.87);\n  //navigator.geolocation.getCurrentPosition(function (position) {\n  //    myLocation =L.latLng(position.coords.latitude, position.coords.longitude);\n  //  console.log(myLocation);\n  //});\n  const blackOptions = { color: 'black', weight: 1 };\n  \n  const fillRedOptions = { color: 'red' };\n  const fillOrangeOptions = { color: 'orange' };\n  const fillYellowOptions = { color: 'yellow' };\n  const fillGreenOptions = { color: 'green' };\n  const fillBlueOptions = { color: 'blue' };\n\n  return (\n    <>\n      <h1>Marine Traffic Tracks</h1>\n      <MapContainer center={myLocation} zoom={8} scrollWheelZoom={false}>\n        <TileLayer\n          attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n          url=\"https://tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png\"\n        />\n        {vessels.map(v => {\n          const line = v.features.map(f => { return { key: f._id, value: L.latLng(f.geometry.coordinates[1], f.geometry.coordinates[0]), feature: f }; });\n\n          return line.map(a => {\n            const visual = a.feature.properties.timestampExternal > Date.now() - (1 * 1000 * 60 * 60) ? { color: fillRedOptions, radius: 200 } :\n              a.feature.properties.timestampExternal > Date.now() - (12 * 1000 * 60 * 60) ? { color: fillOrangeOptions, radius: 150 } :\n                a.feature.properties.timestampExternal > Date.now() - (24 * 1000 * 60 * 60) ? { color: fillYellowOptions, radius: 100 } :\n                  a.feature.properties.timestampExternal > Date.now() - (48 * 1000 * 60 * 60) ? { color: fillGreenOptions, radius: 50 } :\n                    { color: fillBlueOptions, radius: 20 };\n            return (\n              <Circle key={`${a.feature._id}-circle`} center={a.value} pathOptions={visual.color} radius={visual.radius} >\n                <Tooltip sticky>{new Date(a.feature.properties.timestampExternal).toLocaleString()}</Tooltip>\n              </Circle>\n            );\n          });\n        })\n        }\n        {vessels.map(v => {\n          const line = v.features.sort((a, b) => a.properties.timestampExternal > b.properties.timestampExternal ? -1 : 1).map(f => { return L.latLng(f.geometry.coordinates[1], f.geometry.coordinates[0]); });\n          return (\n            <>\n              <Polyline key={`${v._id}-line`} pathOptions={blackOptions} positions={line} />\n              {v.features[0] !== undefined &&\n                <Circle key={`${v._id}-ship`} center={L.latLng(v.features[0].geometry.coordinates[1], v.features[0].geometry.coordinates[0])} pathOptions={blackOptions} radius={400} >\n                  <Tooltip direction=\"bottom\" offset={[0, 20]} opacity={1} >\n                    {`Name: ${v.name}`} <br />{`Destination: ${v.destination}`} <br /> {new Date(v.features[0].properties.timestampExternal).toLocaleString()}\n                  </Tooltip>\n                </Circle>\n              }\n            </>\n          );\n        })\n        }\n      </MapContainer>\n\n    </>\n  );\n};\n\nexport default App;\n","import { Action } from 'redux';\nimport { setVesselList } from './actions';\nimport { RootState } from '../';\nimport { ThunkAction } from 'redux-thunk';\nimport axios from 'axios';\nimport { Vessel } from './types';\nconst baseUrl = '/api/vessels';\n\nexport const thunkSetVesselList = (): ThunkAction<void, RootState, unknown, Action<string>> => async dispatch => {\n  const { data: vessels } = await axios.get<Vessel[]>(baseUrl);\n  dispatch(setVesselList(vessels));\n};","import { SET_VESSEL_LIST, VesselActionTypes, VesselState } from './types';\n\nconst initialState: VesselState = {\n  vessels: []\n};\n\nexport function vesselReducer(\n  state = initialState,\n  action: VesselActionTypes\n): VesselState {\n  switch (action.type) {\n    case SET_VESSEL_LIST:\n      return {\n        ...state, vessels: action.payload\n      };\n    default:\n      return state;\n  }\n}","import { applyMiddleware, combineReducers, createStore } from \"redux\";\nimport thunk from 'redux-thunk';\nimport { composeWithDevTools } from 'redux-devtools-extension';\nimport { vesselReducer } from './vessels/reducers';\n\nexport const rootReducer = combineReducers({\n  vessels: vesselReducer\n});\n\nexport const store = createStore(\n  rootReducer,\n  composeWithDevTools(\n    applyMiddleware(thunk)\n  )\n);\nexport type RootState = ReturnType<typeof rootReducer>;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'semantic-ui-css/semantic.min.css';\n\nimport { Provider } from 'react-redux';\nimport App from './App';\nimport { store } from './store';\n\n\n\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}